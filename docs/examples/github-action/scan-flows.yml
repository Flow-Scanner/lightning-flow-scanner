# .github/workflows/flow-scan.yml
name: Flow Scanner

on:
  pull_request:
    branches: [ main ]

jobs:
  scan-flows:
    runs-on: ubuntu-latest
    permissions:
      contents: read           # Read flow files
      security-events: write   # Upload SARIF to Code Scanning

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Run Flow Scanner
        id: flowscanner
        uses: Flow-Scanner/lightning-flow-scanner@main
        with:
          outputMode: sarif      # optional (default)

      - name: Upload SARIF to Code Scanning
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: ${{ steps.flowscanner.outputs.sarifPath }}